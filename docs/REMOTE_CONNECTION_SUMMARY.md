# è¿œç¨‹è¿æ¥åŠŸèƒ½å®ç°æ€»ç»“

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. **æ ¸å¿ƒæ¶æ„ä¿®æ”¹**

#### `shared/protocol/zmq_topics.h`
- âœ… æ·»åŠ  `Config` å•ä¾‹ç±»ï¼Œæ”¯æŒåŠ¨æ€é…ç½®æœåŠ¡å™¨åœ°å€
- âœ… ä¿ç•™å‘åå…¼å®¹çš„é™æ€åœ°å€å¸¸é‡
- âœ… æä¾› `setServerAddress()`, `setPubPort()`, `setRepPort()` æ¥å£

#### `qt_manager/src/network/ZmqWorker.cpp`
- âœ… ä½¿ç”¨ `Config::instance().getSubMarketAddr()` æ›¿ä»£ç¡¬ç¼–ç åœ°å€
- âœ… ä½¿ç”¨ `Config::instance().getReqCmdAddr()` æ›¿ä»£ç¡¬ç¼–ç åœ°å€
- âœ… æ”¯æŒåŠ¨æ€è¿æ¥åˆ°ä¸åŒæœåŠ¡å™¨

#### `qt_manager/src/main.cpp`
- âœ… æ·»åŠ  `config.json` åŠ è½½é€»è¾‘
- âœ… åœ¨å¯åŠ¨æ—¶é…ç½® ZMQ è¿æ¥åœ°å€
- âœ… æä¾›é»˜è®¤å€¼ï¼ˆ127.0.0.1:5555/5556ï¼‰

### 2. **é…ç½®æ–‡ä»¶**

#### `qt_manager/config.json`
```json
{
    "connection": {
        "server_address": "127.0.0.1",
        "pub_port": 5555,
        "rep_port": 5556
    }
}
```

### 3. **æ–‡æ¡£**

- âœ… åˆ›å»º `docs/REMOTE_CONNECTION.md` è¯¦ç»†ä½¿ç”¨æŒ‡å—
- âœ… åŒ…å« Linux å’Œ Windows é…ç½®è¯´æ˜
- âœ… åŒ…å«å®‰å…¨å»ºè®®å’Œæ•…éšœæ’æŸ¥

---

## ğŸ¯ ä½¿ç”¨æ–¹å¼

### **Linux å¼€å‘æ¨¡å¼**

```bash
# 1. ä½¿ç”¨é»˜è®¤é…ç½®ï¼ˆæˆ–ä¸åˆ›å»º config.jsonï¼‰
cd /home/zd/A-Trader/qt_manager/build
./qt_manager

# è‡ªåŠ¨è¿æ¥åˆ° 127.0.0.1:5555/5556
```

### **Windows ç”Ÿäº§æ¨¡å¼**

```bash
# 1. å°† config.json æ”¾åœ¨ qt_manager.exe åŒç›®å½•
# 2. ä¿®æ”¹ server_address ä¸º Linux æœåŠ¡å™¨ IP
{
    "connection": {
        "server_address": "192.168.1.10",  # ä¿®æ”¹è¿™é‡Œ
        "pub_port": 5555,
        "rep_port": 5556
    }
}

# 3. è¿è¡Œ qt_manager.exe
```

---

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### **è¿æ¥æµç¨‹**

```
1. Qt Manager å¯åŠ¨
   â†“
2. è¯»å– config.json
   â†“
3. é…ç½® zmq_topics::Config å•ä¾‹
   â†“
4. ZmqWorker ä½¿ç”¨åŠ¨æ€åœ°å€è¿æ¥
   â†“
5. å»ºç«‹ SUB (5555) å’Œ REQ (5556) è¿æ¥
```

### **ç½‘ç»œåè®®**

- **PUB/SUB (5555)**ï¼šè¡Œæƒ…å¹¿æ’­ï¼ˆå•å‘æ¨é€ï¼‰
- **REQ/REP (5556)**ï¼šæŒ‡ä»¤äº¤äº’ï¼ˆåŒå‘è¯·æ±‚/å“åº”ï¼‰

### **å®‰å…¨æ€§**

- âœ… æ”¯æŒ SSH éš§é“åŠ å¯†
- âœ… æ”¯æŒé˜²ç«å¢™ IP ç™½åå•
- âœ… å»ºè®®ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ VPN

---

## ğŸ“¦ Windows ç¼–è¯‘ä¾èµ–

### **å¿…éœ€ç»„ä»¶**

1. **Qt 6.x** (MSVC æˆ– MinGW ç‰ˆæœ¬)
2. **ZeroMQ** (é€šè¿‡ vcpkg æˆ– MSYS2 å®‰è£…)
3. **nlohmann-json** (é€šè¿‡ vcpkg æˆ– MSYS2 å®‰è£…)
4. **CMake 3.16+**

### **ç¼–è¯‘å‘½ä»¤**

```cmd
# MSVC
cmake .. -G "Visual Studio 17 2022" -DCMAKE_TOOLCHAIN_FILE=C:\vcpkg\scripts\buildsystems\vcpkg.cmake
cmake --build . --config Release

# MinGW
cmake .. -G "MinGW Makefiles"
cmake --build .
```

---

## ğŸ§ª æµ‹è¯•éªŒè¯

### **1. Linux ç«¯æµ‹è¯•**

```bash
# å¯åŠ¨ Core
cd /home/zd/A-Trader/ctp_core/build
./ctp_core

# æ£€æŸ¥ç«¯å£ç›‘å¬
netstat -tuln | grep 555
# åº”è¾“å‡ºï¼š
# tcp  0.0.0.0:5555  LISTEN
# tcp  0.0.0.0:5556  LISTEN
```

### **2. æœ¬åœ°æµ‹è¯•**

```bash
# ä½¿ç”¨é»˜è®¤é…ç½®å¯åŠ¨ Qt Manager
cd /home/zd/A-Trader/qt_manager/build
./qt_manager

# æŸ¥çœ‹æ—¥å¿—è¾“å‡º
# [Main] Loaded config: Server = 127.0.0.1 PubPort = 5555 RepPort = 5556
# [ZmqWorker] Connecting to: tcp://127.0.0.1:5555
```

### **3. è¿œç¨‹æµ‹è¯•**

```bash
# ä¿®æ”¹ config.json
{
    "connection": {
        "server_address": "192.168.1.10",
        ...
    }
}

# é‡æ–°å¯åŠ¨ Qt Manager
./qt_manager

# åº”è¯¥èƒ½è¿æ¥åˆ°è¿œç¨‹æœåŠ¡å™¨
```

---

## ğŸš€ ä¼˜åŠ¿

1. **çµæ´»éƒ¨ç½²**ï¼šå¼€å‘ç”¨ Linuxï¼Œç”Ÿäº§ç”¨ Windows
2. **é›¶ä»£ç ä¿®æ”¹**ï¼šåªéœ€ä¿®æ”¹é…ç½®æ–‡ä»¶
3. **å‘åå…¼å®¹**ï¼šä¸å½±å“ç°æœ‰ä»£ç 
4. **å®‰å…¨å¯æ§**ï¼šæ”¯æŒå¤šç§å®‰å…¨æ–¹æ¡ˆ

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **é˜²ç«å¢™**ï¼šç¡®ä¿ Linux æœåŠ¡å™¨å¼€æ”¾ 5555/5556 ç«¯å£
2. **ç½‘ç»œå»¶è¿Ÿ**ï¼šå±€åŸŸç½‘å»¶è¿Ÿ <5msï¼Œå¹¿åŸŸç½‘å–å†³äºç½‘ç»œè´¨é‡
3. **é…ç½®æ–‡ä»¶**ï¼šå¿…é¡»æ”¾åœ¨å¯æ‰§è¡Œæ–‡ä»¶åŒç›®å½•
4. **CTP Core**ï¼šå¿…é¡»å…ˆå¯åŠ¨ï¼ŒQt Manager æ‰èƒ½è¿æ¥

---

## ğŸ‰ å®ŒæˆçŠ¶æ€

- âœ… æ ¸å¿ƒä»£ç ä¿®æ”¹å®Œæˆ
- âœ… é…ç½®æ–‡ä»¶æ”¯æŒå®Œæˆ
- âœ… ç¼–è¯‘æµ‹è¯•é€šè¿‡
- âœ… æ–‡æ¡£ç¼–å†™å®Œæˆ
- â³ Windows ç¼–è¯‘å¾…æµ‹è¯•
- â³ è¿œç¨‹è¿æ¥å¾…æµ‹è¯•

---

**ç°åœ¨æ‚¨å¯ä»¥ï¼š**
1. åœ¨ Linux ä¸Šç»§ç»­å¼€å‘ï¼ˆä½¿ç”¨ 127.0.0.1ï¼‰
2. å°†æ¥åœ¨ Windows ä¸Šç¼–è¯‘å¹¶è¿æ¥åˆ° Linux æœåŠ¡å™¨
3. é€šè¿‡ä¿®æ”¹ `config.json` è½»æ¾åˆ‡æ¢æœåŠ¡å™¨

**ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼** ğŸŠ
